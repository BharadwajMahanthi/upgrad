<!-- templates/recipe_detail.html -->
{% extends "base.html" %}

{% block title %}{{ recipe.recipe_name }} - Recipe Details{% endblock %}

{% block content %}
    <h1>{{ recipe.recipe_name }}</h1>
    {% if recipe.image_url %}
        <img src="{{ recipe.image_url }}" alt="{{ recipe.recipe_name }}" width="300">
    {% endif %}

    <h2>Ingredients:</h2>
    <p>{{ recipe.ingredients }}</p>

    <h2>Instructions:</h2>
    <p>{{ recipe.instructions }}</p>

    <h2>Nutritional Information:</h2>
    <ul>
        <li>Calories: {{ recipe.calories }}</li>
        <li>Protein: {{ recipe.protein }}</li>
        <li>Fat: {{ recipe.fat }}</li>
        <li>Carbohydrates: {{ recipe.carbohydrates }}</li>
        <li>Fiber: {{ recipe.fiber }}</li>
    </ul>

    <h2>Reviews:</h2>
    {% if reviews %}
        <ul>
            {% for review in reviews %}
                <li>
                    <strong>User ID:</strong> {{ review.user_id }}<br>
                    <strong>Rating:</strong> {{ review.rating }}<br>
                    <strong>Comment:</strong> {{ review.comment }}<br>
                    <em>Posted on: {{ review.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</em>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No reviews yet. Be the first to review this recipe!</p>
    {% endif %}

    <h3>Submit Your Review:</h3>
    <form method="post">
        <label for="user_id">Your User ID:</label><br>
        <input type="text" name="user_id" id="user_id" required><br><br>

        <label for="rating">Rating (0-5):</label><br>
        <input type="number" name="rating" id="rating" min="0" max="5" step="0.5" required><br><br>

        <label for="comment">Comment:</label><br>
        <textarea name="comment" id="comment" rows="4" cols="50" required></textarea><br><br>

        <input type="submit" value="Submit Review">
    </form>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <a href="{{ url_for('home') }}">Back to Home</a>
{% endblock %}
